Search.setIndex({"docnames": ["aot_autograd", "batch_norm", "experimental", "functorch", "generated/functorch.combine_state_for_ensemble", "generated/functorch.compile.aot_function", "generated/functorch.compile.aot_module", "generated/functorch.compile.default_partition", "generated/functorch.compile.memory_efficient_fusion", "generated/functorch.compile.min_cut_rematerialization_partition", "generated/functorch.compile.nop", "generated/functorch.compile.ts_compile", "generated/functorch.functionalize", "generated/functorch.grad", "generated/functorch.grad_and_value", "generated/functorch.hessian", "generated/functorch.jacfwd", "generated/functorch.jacrev", "generated/functorch.jvp", "generated/functorch.make_functional", "generated/functorch.make_functional_with_buffers", "generated/functorch.vjp", "generated/functorch.vmap", "index", "install", "notebooks/aot_autograd_optimizations", "notebooks/ensembling", "notebooks/jacobians_hessians", "notebooks/minifier", "notebooks/neural_tangent_kernels", "notebooks/per_sample_grads", "notebooks/whirlwind_tour", "ux_limitations"], "filenames": ["aot_autograd.rst", "batch_norm.rst", "experimental.rst", "functorch.rst", "generated/functorch.combine_state_for_ensemble.rst", "generated/functorch.compile.aot_function.rst", "generated/functorch.compile.aot_module.rst", "generated/functorch.compile.default_partition.rst", "generated/functorch.compile.memory_efficient_fusion.rst", "generated/functorch.compile.min_cut_rematerialization_partition.rst", "generated/functorch.compile.nop.rst", "generated/functorch.compile.ts_compile.rst", "generated/functorch.functionalize.rst", "generated/functorch.grad.rst", "generated/functorch.grad_and_value.rst", "generated/functorch.hessian.rst", "generated/functorch.jacfwd.rst", "generated/functorch.jacrev.rst", "generated/functorch.jvp.rst", "generated/functorch.make_functional.rst", "generated/functorch.make_functional_with_buffers.rst", "generated/functorch.vjp.rst", "generated/functorch.vmap.rst", "index.rst", "install.rst", "notebooks/aot_autograd_optimizations.ipynb", "notebooks/ensembling.ipynb", "notebooks/jacobians_hessians.ipynb", "notebooks/minifier.ipynb", "notebooks/neural_tangent_kernels.ipynb", "notebooks/per_sample_grads.ipynb", "notebooks/whirlwind_tour.ipynb", "ux_limitations.rst"], "titles": ["functorch.compile (experimental)", "Patching Batch Norm", "functorch.experimental", "functorch", "functorch.combine_state_for_ensemble", "functorch.compile.aot_function", "functorch.compile.aot_module", "functorch.compile.default_partition", "functorch.compile.memory_efficient_fusion", "functorch.compile.min_cut_rematerialization_partition", "functorch.compile.nop", "functorch.compile.ts_compile", "functorch.functionalize", "functorch.grad", "functorch.grad_and_value", "functorch.hessian", "functorch.jacfwd", "functorch.jacrev", "functorch.jvp", "functorch.make_functional", "functorch.make_functional_with_buffers", "functorch.vjp", "functorch.vmap", "functorch", "Install functorch", "AOT Autograd - How to use and optimize?", "Model ensembling", "Jacobians, Hessians, hvp, vhp, and more: composing functorch transforms", "Using the Minifier", "Neural Tangent Kernels", "Per-sample-gradients", "Whirlwind Tour", "UX Limitations"], "terms": {"aot": [0, 7, 9, 23, 31], "autograd": [0, 5, 7, 9, 12, 19, 20, 22, 23, 27, 30, 31], "i": [0, 1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 32], "an": [0, 1, 3, 4, 5, 9, 12, 15, 16, 17, 19, 20, 22, 24, 26, 27, 28, 29, 30, 31, 32], "featur": [0, 24, 25, 27, 28], "allow": [0, 1, 16, 23, 25, 31, 32], "ahead": [0, 5, 25, 31], "time": [0, 5, 17, 18, 21, 22, 25, 27, 29, 30, 31, 32], "captur": 0, "forward": [0, 3, 5, 6, 7, 8, 9, 12, 14, 15, 16, 18, 25, 26, 28, 29, 30, 31], "backward": [0, 5, 6, 7, 8, 9, 12, 19, 20, 24, 25, 27, 28, 30, 31, 32], "graph": [0, 5, 6, 7, 8, 9, 10, 11, 12, 25, 27, 28, 31], "easi": [0, 27, 29], "integr": [0, 3, 4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25], "thi": [0, 1, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32], "creat": [0, 4, 9, 28, 30], "hack": 0, "python": [0, 5, 8, 12, 13, 14, 15, 16, 17, 18, 21, 22, 26, 30], "base": [0, 25, 32], "develop": [0, 25], "environ": 0, "speedup": [0, 25, 26, 30], "train": [0, 4, 25, 29, 30], "pytorch": [0, 3, 4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 29, 30, 31], "model": [0, 1, 3, 4, 11, 12, 13, 19, 20, 22, 23, 25, 27, 30, 31, 32], "current": [0, 9, 28, 30], "live": 0, "insid": [0, 13, 17, 21, 32], "namespac": [0, 31], "ar": [0, 1, 3, 7, 9, 12, 17, 19, 20, 21, 22, 25, 26, 27, 28, 29, 30, 32], "like": [0, 1, 3, 5, 6, 7, 8, 9, 10, 11, 12, 15, 16, 17, 22, 23, 26, 27, 28, 29, 30, 31, 32], "chang": [0, 4, 5, 6, 7, 8, 9, 10, 11, 27, 30, 32], "we": [0, 1, 3, 4, 9, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32], "look": [0, 3, 24, 25, 26, 28, 29], "feedback": [0, 4], "If": [0, 1, 3, 9, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 24, 25, 26, 27, 28, 29, 30, 32], "you": [0, 1, 3, 4, 8, 12, 15, 16, 17, 18, 19, 20, 22, 24, 26, 27, 28, 29, 30, 31, 32], "interest": [0, 27], "us": [0, 1, 3, 4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 27, 29, 31, 32], "need": [0, 1, 3, 5, 24, 27, 29, 32], "help": [0, 7, 9, 12, 13, 22, 24, 25, 27], "have": [0, 1, 4, 7, 8, 12, 19, 20, 22, 25, 26, 27, 28, 30, 32], "suggest": [0, 27, 29], "pleas": [0, 1, 3, 4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 30, 31, 32], "feel": 0, "free": 0, "open": [0, 26, 30, 32], "issu": [0, 1, 17, 22, 26, 30, 31, 32], "happi": 0, "requir": [1, 22, 24, 27, 32], "place": [1, 7, 12, 26, 28, 30], "updat": 1, "running_mean": 1, "running_var": 1, "same": [1, 4, 12, 15, 16, 17, 18, 21, 22, 25, 26, 27, 28, 30, 32], "size": [1, 4, 17, 18, 22, 26, 27, 28, 29, 30], "input": [1, 3, 5, 6, 7, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 22, 23, 25, 26, 27, 28, 29, 30, 31, 32], "doe": [1, 22, 25, 27, 28, 32], "support": [1, 5, 18, 21, 24, 32], "inplac": [1, 12], "regular": [1, 19, 20, 30], "tensor": [1, 5, 7, 8, 12, 13, 14, 15, 16, 17, 18, 21, 22, 25, 26, 27, 28, 31, 32], "take": [1, 3, 5, 8, 12, 13, 14, 15, 16, 17, 18, 21, 22, 27, 28, 30, 31, 32], "e": [1, 7, 12, 17, 19, 20, 26, 27, 28, 30, 32], "add_": [1, 12, 32], "so": [1, 15, 16, 18, 19, 20, 25, 27, 28, 32], "when": [1, 5, 12, 13, 18, 21, 22, 29, 31, 32], "vmape": 1, "over": [1, 3, 4, 8, 15, 17, 19, 20, 22, 23, 25, 26, 27, 29, 30, 31, 32], "singl": [1, 13, 14, 17, 22, 23, 27, 29, 30, 31, 32], "modul": [1, 4, 6, 7, 8, 9, 10, 11, 19, 20, 22, 23, 26, 29, 30], "end": [1, 25], "up": [1, 12, 25, 26, 29, 30], "error": [1, 15, 16, 18, 22, 28, 32], "all": [1, 4, 12, 18, 21, 25, 26, 29, 31, 32], "assum": [1, 28, 31], "don": [1, 27, 32], "t": [1, 12, 13, 19, 20, 22, 26, 27, 28, 29, 30, 31, 32], "run": [1, 4, 9, 12, 17, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32], "stat": 1, "re": [1, 3, 4, 19, 20, 24, 25, 26, 27, 28, 29, 30, 31, 32], "mean": [1, 13, 25, 31], "won": 1, "evalu": [1, 18, 27, 29], "mode": [1, 4, 12, 15, 16, 17, 18, 21, 29, 31, 32], "case": [1, 13, 17, 21, 23, 26, 27, 28, 29, 30, 31, 32], "involv": [1, 32], "vmap": [1, 4, 13, 16, 17, 23, 27, 29, 30], "file": [1, 15, 16, 18, 28, 32], "ve": [1, 3, 4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 30, 32], "built": 1, "yourself": 1, "can": [1, 3, 5, 10, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 25, 26, 27, 28, 29, 30, 31, 32], "In": [1, 3, 13, 17, 21, 25, 26, 27, 29, 30, 32], "other": [1, 8, 12, 13, 14, 15, 18, 21, 23, 25, 27, 28, 29, 30, 31, 32], "word": 1, "anywher": 1, "set": [1, 5, 8, 9, 19, 20, 25, 28], "track_running_stat": 1, "flag": [1, 13, 14, 16, 17, 18, 19, 20, 21, 22, 32], "fals": [1, 5, 13, 14, 16, 17, 18, 19, 20, 21, 29], "batchnorm2d": 1, "64": [1, 4, 16, 17, 26, 27, 30, 31], "some": [1, 12, 22, 23, 25, 26, 27, 28, 29, 30, 31, 32], "resnet": 1, "regnet": 1, "norm_lay": 1, "These": [1, 7, 23, 25, 28, 31], "often": [1, 25], "default": [1, 5, 7, 9, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 25, 26, 31, 32], "thei": [1, 4, 19, 20, 27], "been": [1, 8, 12, 27, 29], "instead": [1, 3, 4, 9, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 27, 28, 29, 32], "doesn": [1, 12, 22, 27, 28, 32], "import": [1, 12, 13, 15, 16, 17, 18, 19, 20, 24, 25, 26, 27, 28, 29, 30, 31, 32], "from": [1, 9, 12, 13, 15, 16, 17, 18, 19, 20, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32], "functool": [1, 26, 27, 30], "partial": [1, 21, 26, 27, 30], "resnet18": 1, "ha": [1, 12, 15, 16, 19, 20, 22, 23, 25, 26, 27, 28, 29, 30, 31, 32], "ad": [1, 15, 16, 18, 27, 29, 31, 32], "function": [1, 4, 5, 6, 8, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 25, 26, 27, 28, 30, 32], "quick": [1, 26, 27, 30], "net": [1, 29], "want": [1, 3, 4, 8, 12, 19, 20, 26, 27, 29, 32], "replace_all_batch_norm_modules_": 1, "experiment": [1, 5, 6, 7, 8, 9, 10, 11, 12, 23, 31], "As": [3, 4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 27], "final": [3, 4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 27, 28, 29, 30, 32], "step": [3, 4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 29], "api": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 15, 16, 18, 22, 25, 27], "deprec": [3, 4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24], "2": [3, 4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 30, 31, 32], "0": [3, 4, 5, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32], "func": [3, 4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 29, 31, 32], "see": [3, 4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 32], "migrat": [3, 4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "guid": [3, 4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "doc": [3, 4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "more": [3, 4, 5, 8, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 25, 29, 31, 32], "detail": [3, 4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 29, 31], "gener": [3, 5, 7, 8, 9, 12, 22, 23, 26, 27, 29, 30], "call": [3, 12, 19, 20, 22, 23, 25, 28, 30, 31, 32], "For": [3, 4, 22, 23, 24, 25, 26, 28, 31, 32], "exampl": [3, 4, 5, 12, 13, 14, 19, 20, 22, 23, 25, 26, 27, 28, 29, 30, 31, 32], "follow": [3, 5, 19, 20, 24, 25, 27, 28, 32], "comput": [3, 9, 12, 13, 14, 15, 16, 17, 18, 21, 22, 23, 30], "jacobian": [3, 16, 17, 18, 21, 22, 23, 32], "three": [3, 32], "valu": [3, 4, 12, 13, 14, 18, 21, 32], "return": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 26, 27, 28, 29, 30, 31, 32], "linear": [3, 4, 13, 19, 20, 22, 26, 27, 29, 30, 31], "3": [3, 4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 26, 28, 29, 30, 31, 32], "def": [3, 5, 12, 13, 15, 16, 17, 19, 20, 21, 22, 25, 26, 27, 28, 29, 30, 31, 32], "f": [3, 12, 13, 15, 16, 17, 18, 21, 22, 23, 26, 27, 28, 30, 31, 32], "x": [3, 5, 13, 15, 16, 17, 18, 19, 20, 21, 22, 24, 25, 26, 27, 28, 29, 30, 31, 32], "randn": [3, 4, 5, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 25, 26, 27, 28, 29, 30, 31, 32], "jacrev": [3, 15, 16, 29, 32], "assert": [3, 4, 13, 15, 16, 17, 18, 21, 22, 25, 26, 27, 29, 30, 31, 32], "shape": [3, 4, 16, 17, 21, 22, 26, 27, 28, 29, 30, 31], "howev": [3, 12, 16, 17, 21, 22, 25, 26, 28, 32], "do": [3, 17, 23, 24, 25, 26, 27, 28, 29, 31, 32], "someth": 3, "paramet": [3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 26, 27, 29, 30], "wai": [3, 4, 12, 27, 28, 29], "construct": [3, 22, 27, 32], "where": [3, 16, 17, 18, 21, 22, 26, 29, 30, 32], "That": [3, 24, 27, 29], "": [3, 4, 12, 13, 14, 15, 16, 17, 19, 20, 22, 25, 26, 27, 28, 29, 30, 32], "what": [3, 16, 28, 29, 32], "make_funct": [3, 20, 29], "make_functional_with_buff": [3, 19, 29, 30], "given": [3, 4, 19, 20, 21, 27, 28, 30, 31], "new": [3, 6, 12, 22, 23, 28, 30, 31, 32], "accept": [3, 5, 22, 23, 27, 29, 30, 31], "pass": [3, 6, 7, 12, 16, 17, 18, 21, 25, 26, 28, 29, 30, 31, 32], "inform": [3, 12], "fix": [3, 12, 32], "batch": [3, 16, 17, 22, 23, 26, 29, 30, 31, 32], "norm": 3, "guidanc": 3, "here": [3, 4, 19, 20, 24, 25, 26, 27, 29, 30, 32], "patch": 3, "param": [4, 19, 20, 26, 27, 29, 30], "buffer": [4, 6, 19, 20, 26, 29, 30], "sourc": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], "prepar": [4, 26], "list": [4, 30, 32], "torch": [4, 5, 6, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 26, 27, 28, 29, 30, 31], "nn": [4, 6, 8, 19, 20, 23, 26, 27, 29, 30], "ensembl": [4, 23, 31], "m": [4, 26, 27, 30], "class": [4, 26, 29, 30, 32], "stack": [4, 22, 26, 27, 29, 30, 32], "togeth": [4, 13, 17, 21, 23, 26, 31], "make": [4, 8, 19, 20, 27], "each": [4, 13, 14, 18, 21, 22, 23, 26, 27, 29, 30, 31, 32], "result": [4, 7, 9, 12, 13, 16, 17, 21, 22, 27, 28, 29, 30, 31, 32], "addit": [4, 25, 26], "dimens": [4, 22, 26, 30, 31, 32], "also": [4, 12, 18, 21, 22, 25, 27, 30, 31, 32], "version": [4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 26, 27, 30], "one": [4, 5, 8, 12, 13, 14, 15, 16, 17, 18, 21, 22, 25, 27, 30, 31, 32], "One": [4, 5, 12, 22, 26, 28], "cannot": [4, 23, 31, 32], "directli": [4, 12, 27], "arg": [4, 5, 6, 15, 16, 17, 22, 25, 26], "kwarg": [4, 6, 8, 21, 22], "probabl": 4, "how": [4, 12, 23, 26, 28, 29, 30, 31, 32], "veri": [4, 13, 22, 31], "simpl": [4, 5, 13, 21, 22, 25, 26, 27, 29, 30, 31], "num_model": [4, 26, 30], "5": [4, 5, 13, 15, 16, 17, 18, 21, 22, 26, 28, 29, 30, 31], "batch_siz": [4, 13, 22, 27, 30, 31], "in_featur": [4, 30], "out_featur": [4, 30], "rang": [4, 25, 26, 28, 30], "data": [4, 12, 26, 27, 29, 30], "fmodel": [4, 26, 30], "output": [4, 7, 9, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 25, 26, 27, 28, 29, 30, 31, 32], "none": [4, 5, 9, 12, 13, 17, 22, 25, 26, 27, 28, 29, 30, 31, 32], "being": [4, 12, 21, 32], "must": [4, 5, 8, 13, 14, 15, 16, 17, 18, 21, 22, 26, 32], "except": [4, 22, 26, 27, 30], "should": [4, 12, 13, 17, 21, 22, 26, 29, 30, 32], "v": [4, 22, 30], "eval": 4, "subject": 4, "investig": [4, 32], "better": [4, 15, 16, 25, 27, 30], "would": [4, 16, 17, 27, 30, 32], "love": [4, 31], "your": [4, 24, 27, 28, 29, 31, 32], "improv": [4, 25, 27, 30], "delet": [4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], "futur": [4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 24, 27, 32], "stack_module_st": 4, "releas": [4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], "note": [4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 25, 26, 27, 28, 30, 31], "http": [4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 30], "org": [4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], "main": [4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 28], "html": [4, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22], "fn": [5, 8, 13, 22, 25], "fw_compil": [5, 25, 28], "bw_compil": [5, 25, 28], "partition_fn": [5, 25], "default_partit": 5, "decomposit": 5, "num_params_buff": 5, "keep_inference_input_mut": 5, "inference_compil": 5, "dynam": 5, "enable_log": 5, "true": [5, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 25, 27, 28, 30, 31, 32], "trace": [5, 6, 7, 9, 25, 29], "dispatch": [5, 6, 28], "mechan": [5, 6, 25], "through": [5, 6, 8, 9, 15, 22, 25, 26, 27, 29, 30, 32], "joint": [5, 7, 9, 25], "separ": [5, 23, 24, 26, 30, 31], "out": [5, 12, 13, 15, 16, 18, 22, 23, 25, 27, 28, 31], "The": [5, 7, 9, 11, 12, 15, 18, 19, 20, 21, 22, 25, 26, 27, 29, 30, 31, 32], "partition": [5, 7, 8, 23, 25], "perform": [5, 6, 8, 12, 15, 25, 27, 29], "optim": [5, 8, 23, 26, 30], "recomput": [5, 8, 9], "dictionari": 5, "decompos": [5, 12], "oper": [5, 7, 12, 13, 15, 16, 17, 18, 22, 26, 27, 28, 29, 30, 31], "sequenc": [5, 22], "core": 5, "simpler": [5, 22, 31], "backend": [5, 12, 25, 31], "callabl": [5, 6, 7, 8, 12, 13, 14, 21, 25], "A": [5, 6, 8, 12, 13, 14, 15, 16, 17, 18, 21, 22, 23, 26, 30, 31], "ore": [5, 8], "argument": [5, 8, 12, 13, 14, 15, 16, 17, 18, 21, 22, 27, 30, 32], "fx": [5, 7, 9, 10, 11, 12, 25, 28, 31], "aten": [5, 12, 25, 28], "op": [5, 9, 10, 12, 25, 28], "semant": [5, 12, 22], "equival": [5, 12, 15, 17, 22, 30, 32], "option": [5, 9, 12, 15, 16, 17, 26, 31], "partit": [5, 7, 9], "dict": [5, 22], "defin": [5, 29, 30, 32], "larger": [5, 12], "invok": [5, 19, 20], "retain": [5, 6, 8], "eager": [5, 6, 8, 25, 28], "behavior": [5, 6, 7, 8, 12, 32], "origin": [5, 6, 7, 8, 9, 19, 20, 25, 29, 30], "via": [5, 15, 24, 27, 31], "usag": [5, 15, 16, 17, 27], "print": [5, 12, 25, 26, 27, 28, 29, 30, 32], "lambda": [5, 13, 18, 21, 22, 28, 31], "sin": [5, 13, 15, 16, 17, 21, 25, 27, 28, 31, 32], "co": [5, 13, 16, 17, 21, 25, 28, 31], "print_compile_fn": 5, "fx_modul": [5, 25], "aot_fn": [5, 25], "4": [5, 13, 19, 20, 21, 22, 25, 28], "requires_grad": [5, 13, 19, 20, 22, 25, 28, 31], "mod": [6, 28], "It": [6, 8, 12, 15, 22, 26, 27, 28, 29, 30, 31, 32], "wrapper": [6, 8, 25], "underneath": 6, "aot_funct": [6, 7, 8, 25, 28], "lift": [6, 22, 31], "which": [6, 7, 12, 15, 16, 17, 18, 22, 25, 26, 27, 31, 32], "joint_modul": [7, 9], "_joint_input": [7, 9], "num_fwd_output": [7, 9], "manner": [7, 28], "close": [7, 25], "resembl": 7, "observ": [7, 25], "contain": [7, 18, 21, 22, 25, 28, 31], "those": [7, 22, 32], "execut": [7, 12, 32], "collect": 7, "between": [7, 29], "find": [7, 32], "stash": 7, "becom": [7, 27, 30], "remain": 7, "graphmodul": [7, 9, 11, 25, 28], "aot_modul": 8, "memori": [8, 9, 12, 17, 22, 25, 27, 29], "effici": [8, 23, 27, 29, 31], "fusion": 8, "min_cut_rematerialization_partit": [8, 25], "nvfuser": [8, 9, 25, 28], "union": 8, "ani": [8, 12, 19, 20, 22, 26, 28, 30, 32], "overrid": [8, 28, 32], "whose": 8, "gone": 8, "inductor": 9, "trade": 9, "off": [9, 12, 28], "bandwidth": [9, 25], "To": [9, 28, 32], "fwd": [9, 25], "bwd": [9, 25], "copi": [9, 12, 28], "manual": [9, 26, 30], "just": [9, 25, 27, 29], "And": [9, 19, 20, 27, 29, 30], "dead": [9, 28], "code": [9, 12, 25, 28, 29, 31, 32], "elimin": [9, 26, 27, 28], "unus": [9, 28], "determin": [9, 26, 30, 32], "two": [9, 25, 27, 29, 32], "recomputable_op": 9, "number": [9, 23, 25, 26, 27, 29, 31, 32], "fx_g": [10, 11, 28], "_": [10, 18, 21, 25, 26, 27, 28, 29, 31], "check": [10, 23, 25, 28, 30, 31], "accuraci": 10, "inp": [11, 28], "torchscript": [11, 25], "script": [11, 28], "remov": [12, 28], "mutat": [12, 26, 30], "transform": [12, 13, 17, 19, 20, 21, 26, 29, 30, 32], "intermedi": [12, 25, 27, 28, 32], "alias": [12, 22], "while": [12, 25, 27, 28, 32], "preserv": 12, "everi": [12, 29, 30, 32], "foo_": 12, "get": [12, 15, 16, 17, 25, 26, 27, 28, 30, 32], "replac": [12, 28, 31], "its": [12, 13, 14, 17, 21, 26, 31], "intermediate_upd": 12, "foo": [12, 28], "ship": 12, "program": [12, 24], "compil": [12, 23, 25, 28, 31], "aren": [12, 32], "abl": [12, 24, 26, 30, 32], "easili": [12, 29], "repres": [12, 25], "str": [12, 16, 22, 25], "string": [12, 28], "either": [12, 28, 32], "mutations_and_view": 12, "non": [12, 17, 22, 27, 29], "addition": [12, 16, 17], "view": [12, 29], "were": [12, 22, 26, 32], "after": [12, 24, 25, 26], "finish": 12, "detect": 12, "back": [12, 25, 30, 32], "necessari": 12, "xdoctest": [12, 13, 21], "skip": [12, 13, 21], "proxy_tensor": 12, "make_fx": 12, "onli": [12, 19, 20, 22, 26, 29, 30, 32], "b": [12, 25, 27, 28], "1": [12, 13, 15, 16, 17, 18, 21, 22, 24, 26, 27, 28, 30, 31, 32], "c": [12, 13, 17, 21, 25, 28], "inpt": 12, "out1": 12, "out2": 12, "allclos": [12, 13, 15, 16, 17, 18, 21, 22, 25, 26, 27, 29, 30, 31, 32], "f_trace": 12, "f_no_mutations_trac": 12, "f_no_mutations_and_views_trac": 12, "self": [12, 25, 26, 28, 29, 30], "a_1": 12, "add": [12, 25, 27, 28, 30, 31], "add_1": [12, 25], "view_1": 12, "view_copi": 12, "view_copy_1": 12, "extra": [12, 22], "copy_": 12, "correctli": 12, "appli": [12, 19, 20, 21, 22, 26, 27, 28, 29, 31, 32], "complet": [12, 32], "There": [12, 23, 26, 27, 29, 30, 31, 32], "few": 12, "failur": 12, "worth": 12, "work": [12, 23, 24, 25, 26, 27, 28, 30, 31, 32], "grad": [12, 14, 18, 19, 20, 21, 22, 23, 25, 27, 32], "gradient": [12, 13, 14, 18, 19, 20, 22, 23, 25, 27], "global": [12, 26, 27, 30, 32], "state": [12, 19, 20, 26, 30], "local": 12, "simpli": [12, 27, 28], "around": [12, 26, 27, 29, 30, 32], "ensur": 12, "creation": 12, "wrap": [12, 25, 32], "resize_": 12, "limit": [12, 23, 26, 30], "long": 12, "resiz": 12, "as_strid": 12, "overlap": 12, "mental": [12, 32], "understand": [12, 25], "most": [12, 31, 32], "user": [12, 25, 28, 32], "write": [12, 22, 25, 29, 31, 32], "public": 12, "our": [12, 23, 26, 27, 28, 29, 30, 31, 32], "intern": [12, 25, 32], "logic": 12, "happen": [12, 32], "entir": [12, 28, 30], "level": 12, "know": [12, 26, 29, 30], "map": [12, 22, 26, 27, 30, 31, 32], "g": [12, 16, 17, 19, 20, 26, 30, 32], "track": [12, 19, 20], "line": 12, "thing": [12, 32], "about": [12, 25, 26, 27, 30, 32], "come": [12, 23, 25, 32], "github": [12, 26, 30, 32], "com": [12, 30], "blob": 12, "master": 12, "src": [12, 28], "nativ": 12, "native_funct": 12, "yaml": 12, "argnum": [13, 14, 15, 16, 17, 27], "has_aux": [13, 14, 16, 17, 18, 21, 32], "respect": [13, 14, 15, 16, 17, 18, 21, 27, 28, 30, 31], "specifi": [13, 14, 17, 22, 26], "nest": [13, 22], "higher": [13, 22, 23, 25, 27, 31], "order": [13, 22, 23, 27, 31], "element": [13, 14, 16, 17, 18, 21, 22, 29, 31, 32], "equal": [13, 14], "tupl": [13, 14, 15, 16, 17, 18, 21, 22, 30], "auxiliari": [13, 14, 16, 17, 18, 21, 28], "object": [13, 14, 16, 17, 18, 21, 26, 27, 30], "aux": [13, 14, 16, 17, 18, 21], "int": [13, 14, 15, 16, 17, 22], "integ": [13, 14, 15, 16, 17], "bool": [13, 14, 16, 17, 18, 19, 20, 21], "indic": [13, 14, 16, 17, 18, 21, 22], "By": [13, 14, 16, 17, 22, 26], "first": [13, 14, 16, 17, 18, 21, 22, 24, 26, 27, 28, 29, 30, 31], "cos_x": [13, 31], "second": [13, 16, 17, 18, 21, 22, 27, 30, 31], "neg_sin_x": [13, 31], "compos": [13, 15, 16, 17, 22, 30], "per": [13, 22, 23, 27, 31], "sampl": [13, 22, 23, 27, 31], "feature_s": [13, 22, 31], "weight": [13, 22, 26, 27, 30, 31], "feature_vec": [13, 22, 31], "activ": [13, 22, 27, 31], "dim": [13, 22, 30, 31, 32], "dot": [13, 22, 27, 31, 32], "relu": [13, 22, 26, 29, 30, 31, 32], "compute_loss": [13, 19, 20, 30, 31], "target": [13, 26, 28, 30, 31], "y": [13, 16, 17, 18, 19, 20, 21, 22, 28, 31, 32], "mseloss": [13, 31], "grad_weight_per_exampl": [13, 31], "in_dim": [13, 22, 26, 27, 30, 31, 32], "my_loss_func": 13, "y_pred": 13, "loss_per_sampl": 13, "loss": [13, 25, 30], "y_true": 13, "rand": 13, "w": [13, 28, 31], "r": [13, 15, 18, 22, 27, 29, 31], "no_grad": [13, 17, 21], "inner": [13, 17, 21, 23, 31], "context": [13, 17, 21], "manag": [13, 17, 21], "outer": [13, 17, 21, 27], "becaus": [13, 17, 21, 22, 25, 27, 30, 32], "depend": [13, 17, 21, 27, 28], "outsid": [13, 17, 21, 32], "primal": [14, 18, 21, 27], "index": [15, 16, 17, 22], "revers": [15, 17, 21, 29, 31], "strategi": [15, 27, 28], "jacfwd": [15, 32], "good": [15, 29], "possibl": [15, 19, 20, 26, 27, 28, 32], "composit": [15, 27, 32], "sai": [15, 16, 17, 26, 27, 28], "mai": [15, 16, 18, 24, 26, 27, 29, 32], "implement": [15, 16, 18, 26, 27, 29, 30, 32], "bug": [15, 16, 18], "report": [15, 16, 18], "priorit": [15, 16, 18], "altern": [15, 16, 25, 26], "coverag": [15, 16, 27], "basic": [15, 16, 17], "n": [15, 18, 22, 27, 29, 30], "give": [15, 16, 17, 26, 27, 30], "sum": [15, 16, 17, 21, 25, 27, 29, 31, 32], "hess": [15, 31], "diag": [15, 16, 17, 31], "random": [16, 22, 23, 26, 29], "autodiff": [16, 17, 18, 27], "differenti": [16, 17, 18, 21, 23, 30, 31], "type": [16, 25, 26, 30, 32], "differ": [16, 17, 22, 23, 25, 26, 27, 31, 32], "pointwis": [16, 17, 25], "unari": [16, 17], "diagon": [16, 17, 29], "arrai": [16, 17], "expect": [16, 17, 27, 31, 32], "produc": [16, 17, 22, 26, 27, 31, 32], "well": [16, 17, 31, 32], "jacobian_f": [16, 17], "f_x": [16, 17], "itself": [16, 17, 31], "hessian": [16, 17, 23, 32], "jacboian": [16, 17], "multipl": [16, 17, 18, 21, 22, 24, 26, 32], "expectedx": [16, 17], "ones_lik": [16, 17, 21], "expectedi": [16, 17], "chunk_siz": [17, 22], "_preallocate_and_copi": 17, "row": [17, 22, 27], "loop": [17, 22, 23, 26, 27, 30, 31, 32], "constraint": 17, "applic": 17, "maximum": 17, "chunk": 17, "vjp": [17, 22, 23, 27, 29, 32], "try": [17, 22, 25, 28, 29, 32], "tangent": [18, 23, 27], "strict": 18, "stand": [18, 21], "vector": [18, 21, 22, 23, 30, 32], "product": [18, 21, 22], "known": [18, 31], "posit": [18, 21], "deriv": [18, 21, 27], "structur": [18, 22, 26, 30], "jvp_out": 18, "wish": [18, 29, 30], "ones": [18, 21, 26, 28, 30, 31, 32], "disable_autograd_track": [19, 20], "extract": [19, 20, 25], "mse_loss": [19, 20], "grad_weight": [19, 20], "disabl": [19, 20], "unrel": [19, 20], "them": [19, 20, 25, 26, 27, 28, 29, 30, 32], "aka": [19, 20, 27], "trackabl": [19, 20], "match": [19, 20, 22, 26, 28, 30], "ness": [19, 20], "otherwis": [19, 20, 27, 32], "plan": [19, 20], "avoid": [19, 20, 29], "unnecessarili": [19, 20], "histori": [19, 20], "functional_cal": [19, 20], "cotang": [21, 31], "vjp_fn": [21, 27, 29, 31], "behav": 21, "vjpfunc": 21, "even": [21, 27], "struct": [21, 22], "matmul": 21, "len": 21, "transpos": 21, "scale": [21, 22], "full": [21, 22, 27, 29, 32], "fail": [21, 28], "out_dim": 22, "push": [22, 27], "effect": [22, 25, 26, 30, 32], "handl": [22, 26, 28, 30], "conveni": [22, 25, 26, 27, 28, 31], "whichev": 22, "d": [22, 25, 27, 28, 31], "particular": [22, 26, 29, 30], "appear": 22, "whether": 22, "across": [22, 26, 32], "warn": [22, 28], "numpi": [22, 32], "provid": [22, 25, 27, 28, 31], "unsuccessfulli": 22, "rummag": 22, "batched_dot": 22, "hide": [22, 31], "lead": [22, 25, 26, 31], "author": 22, "experi": [22, 25, 31], "previous": [22, 28, 32], "difficult": [22, 27, 32], "imposs": 22, "engin": 22, "matrix": [22, 27, 29], "usual": [22, 25], "whole": 22, "setup": 22, "i_n": 22, "ey": [22, 27, 29], "sequenti": 22, "approach": [22, 28, 30], "jacobian_row": [22, 27], "retain_graph": 22, "unbind": [22, 32], "get_vjp": 22, "n1": 22, "n0": 22, "along": [22, 25, 28], "0th": [22, 30], "wa": [22, 28, 29, 30], "batched_pow": 22, "autobatch": 22, "variabl": [22, 32], "length": 22, "box": 22, "jax": [23, 29, 31, 32], "numer": [23, 31], "quantiti": [23, 27, 29, 30, 31], "auto": 23, "arbitrarili": [23, 31], "stock": [23, 29, 31], "todai": [23, 31], "tricki": [23, 31], "machin": [23, 31], "task": [23, 31], "maml": [23, 31], "u": [23, 25, 26, 27, 30, 31], "express": [23, 31, 32], "abov": [23, 25, 27, 28, 29, 30, 31], "without": [23, 26, 27, 30, 31], "design": [23, 31, 32], "subsystem": [23, 31], "idea": 23, "framework": 23, "whirlwind": 23, "tour": 23, "mention": 23, "below": [23, 28], "instal": 23, "colab": [23, 26, 27, 30], "nightli": 23, "previou": [23, 28], "conclus": 23, "ux": 23, "util": [23, 25, 26, 27, 30], "hvp": 23, "vhp": 23, "neural": [23, 25], "kernel": [23, 26, 28, 30], "minifi": 23, "13": 24, "now": [24, 25, 27, 28, 29, 30, 32], "includ": 24, "binari": [24, 28], "longer": [24, 32], "packag": 24, "instruct": [24, 28], "ll": [24, 27, 29, 30, 32], "upgrad": 24, "older": [24, 26, 30], "uninstal": 24, "pip": 24, "maintain": 24, "compat": [24, 32], "command": 24, "continu": 24, "forese": 24, "until": [24, 28], "proper": 24, "librari": [24, 31, 32], "newest": 24, "download": 24, "latest": 24, "09": [24, 27], "21": 24, "2022": 24, "11": 24, "12": [24, 27, 30], "tutori": [25, 27, 29, 31], "deep": [25, 27], "toolkit": 25, "assist": 25, "acceler": 25, "broadli": 25, "kei": [25, 28], "presenc": [25, 32], "facilit": [25, 32], "nnc": 25, "tvm": 25, "conjunct": 25, "specif": [25, 28, 32], "enabl": 25, "let": [25, 26, 27, 28, 29, 30, 32], "start": [25, 27, 28, 31], "test": [25, 26, 28], "ref": 25, "__torch_dispatch__": 25, "symbol": 25, "send": 25, "suppli": 25, "functorch": [25, 26, 28, 29, 32], "compiler_fn": 25, "aot_print_fn": 25, "onc": [25, 32], "trigger": 25, "cloned_input": 25, "clone": [25, 27], "detach": 25, "requires_grad_": [25, 26, 27], "cloned_a": 25, "cloned_b": 25, "cloned_c": 25, "cloned_d": 25, "primals_1": [25, 28], "primals_2": 25, "primals_3": 25, "primals_4": 25, "add_2": 25, "cos_1": [25, 28], "tangents_1": [25, 28], "neg": [25, 28], "mul": [25, 28], "sin_1": [25, 28], "neg_1": [25, 28], "mul_1": [25, 28], "save": [25, 27, 28], "calcul": 25, "later": 25, "talk": 25, "network": [25, 29], "cpu": [25, 28], "devic": [25, 26, 28, 29, 30], "cuda": [25, 26, 28, 29, 30], "suitabl": 25, "suit": 25, "alreadi": 25, "ts_compil": 25, "aot_nnc_fn": 25, "correct": [25, 28], "benchmark": [25, 26, 27, 30], "statist": 25, "bench": 25, "prefix": [25, 28], "warmup": 25, "10": [25, 26, 28, 29, 30], "iter": 25, "100": [25, 26, 27, 30], "fw_latenc": 25, "bw_latenc": 25, "fw_begin": 25, "perf_count": 25, "fw_end": 25, "bw_begin": 25, "bw_end": 25, "append": 25, "avg_fw_lat": 25, "6": [25, 28], "avg_bw_lat": 25, "sep": 25, "large_input": 25, "1024": 25, "2048": [25, 27], "982": 25, "6959593920038": 25, "1899": 25, "7003795811906": 25, "734": 25, "2723174951971": 25, "831": 25, "1696897726506": 25, "With": [25, 29], "speed": [25, 26], "both": [25, 27, 29], "earlier": 25, "bound": 25, "thu": [25, 26], "benefit": 25, "prevent": 25, "read": [25, 31], "restrict": [25, 31, 32], "exist": [25, 30], "techniqu": 25, "dure": [25, 29], "incur": 25, "overhead": [25, 27], "fuse": 25, "than": [25, 26, 27, 29, 30, 32], "friendli": 25, "reli": 25, "reduc": [25, 27], "runtim": 25, "refer": 25, "discuss": [25, 29, 31], "post": 25, "similar": [25, 32], "At": 25, "isol": 25, "anoth": [25, 28], "smarter": 25, "awar": 25, "configur": 25, "own": 25, "plug": 25, "zero": [25, 28, 29], "comparison": [25, 27], "printer": 25, "show": [25, 26, 27], "modifi": 25, "compar": [25, 27, 29, 30], "fewer": [25, 27, 32], "memory_efficient_fus": [25, 28], "achiev": 25, "aot_recompute_nnc_fn": 25, "aot_recomp": 25, "740": 25, "7676504226401": 25, "1560": 25, "5240693548694": 25, "713": 25, "8530415249988": 25, "909": 25, "1200679540634": 25, "712": 25, "2249767417088": 25, "791": 25, "4606417762116": 25, "latenc": 25, "lot": [25, 29], "further": 25, "aotautograd": [25, 28], "gpu": [25, 26, 30], "illustr": 26, "combin": [26, 29, 31], "predict": [26, 27, 30], "tradition": 26, "done": [26, 30], "architectur": [26, 29], "demonstr": [26, 29], "mlp": 26, "manual_se": [26, 27, 30, 32], "simplemlp": 26, "__init__": [26, 29, 30], "super": [26, 29, 30], "fc1": [26, 30], "784": 26, "128": [26, 30], "fc2": [26, 30], "fc3": 26, "flatten": [26, 29, 30], "dummi": [26, 27, 30], "pretend": [26, 28, 30], "mnist": [26, 30], "dataset": [26, 30], "imag": [26, 30], "28": [26, 30], "minibatch": [26, 30], "furthermor": [26, 31], "randint": [26, 30], "6400": 26, "coupl": [26, 28], "mayb": 26, "initi": 26, "predictions_diff_minibatch_loop": 26, "zip": [26, 29, 30], "predictions2": 26, "go": [26, 27], "big": 26, "offer": [26, 27], "combine_state_for_ensembl": 26, "stateless": [26, 30, 32], "p": [26, 29], "front": 26, "verifi": [26, 27], "predictions1_vmap": 26, "atol": [26, 29, 30], "1e": [26, 29, 30], "rtol": [26, 30], "tell": 26, "predictions2_vmap": 26, "best": [26, 30], "pure": [26, 30, 32], "side": [26, 30, 32], "unabl": [26, 30, 32], "arbitrari": [26, 30], "mani": [26, 27, 29, 30], "curiou": [26, 30], "googl": 26, "timer": [26, 27, 30], "without_vmap": [26, 27, 30], "stmt": [26, 27, 30], "with_vmap": [26, 27, 30], "timeit": [26, 27, 30], "common": [26, 27, 30, 32], "measur": [26, 27, 30], "0x7fe22c58b3d0": 26, "25": [26, 27], "thread": [26, 27, 30], "0x7fe22c50c450": 26, "879": 26, "larg": [26, 29], "faster": [26, 27, 30], "competit": [26, 30], "though": [26, 30], "haven": [26, 30], "rule": [26, 27, 30], "underli": [26, 30], "weren": [26, 30], "hardwar": [26, 27, 30], "tradit": 27, "learn": [27, 30], "annoi": 27, "standard": [27, 32], "system": [27, 32], "variou": [27, 31], "bia": [27, 30], "tanh": 27, "16": 27, "think": 27, "unit": [27, 29], "compute_jac": 27, "xp": 27, "vec": [27, 29], "unit_vector": 27, "5956": 27, "6096": 27, "1326": 27, "2295": 27, "4490": 27, "3661": 27, "1672": 27, "1190": 27, "1705": 27, "6683": 27, "1851": 27, "1630": 27, "0634": 27, "6547": 27, "5908": 27, "1308": 27, "rid": 27, "ft_jacobian": 27, "confirm": 27, "method": [27, 30], "much": [27, 31], "magic": 27, "down": 27, "primit": 27, "obtain": [27, 28, 30], "deal": 27, "microsecond": 27, "millisecond": 27, "get_perf": [27, 30], "first_descriptor": [27, 30], "second_descriptor": [27, 30], "delta": [27, 28, 30], "slower": 27, "gain": [27, 30], "final_gain": [27, 30], "4f": [27, 30], "percent": [27, 30], "no_vmap_tim": [27, 30], "500": 27, "with_vmap_tim": [27, 30], "0x7fa9a911b350": 27, "0x7fa9a6a99d50": 27, "884": 27, "34": 27, "rel": [27, 29], "60": 27, "7170": 27, "furthemor": 27, "pretti": [27, 28], "flip": 27, "problem": [27, 28, 32], "ft_jac_weight": 27, "ft_jac_bia": 27, "saw": 27, "jvp": [27, 29, 32], "substitut": 27, "characterist": 27, "thumb": 27, "\ud835\udc45": 27, "prefer": [27, 29], "rigor": 27, "column": [27, 29], "taller": 27, "wider": 27, "din": 27, "32": [27, 29, 30], "dout": 27, "rememb": 27, "using_fwd": 27, "using_bwd": 27, "jacfwd_tim": 27, "jacrev_tim": 27, "0x7fa9a5d792d0": 27, "0x7fa9a4dee450": 27, "46": 27, "842": 27, "8274": 27, "0x7fa9a5d64790": 27, "7": [27, 28], "99": 27, "0x7fa9a5d67b50": 27, "perf": 27, "635": 27, "2095": 27, "inde": 27, "under": [27, 32], "hood": 27, "boost": 27, "leverag": [27, 28], "regard": 27, "matric": 27, "blow": 27, "signific": 27, "512": 27, "hess_api": 27, "hess_fwdfwd": 27, "hess_revrev": 27, "regardless": 27, "might": [27, 28, 32], "goe": 27, "easiest": 27, "31": 27, "33": 27, "compute_batch_jacobian": 27, "batch_jacobian0": 27, "certain": [27, 32], "independ": [27, 29, 30], "sometim": 27, "predict_with_output_sum": 27, "batch_jacobian1": 27, "movedim": 27, "\ud835\udc41": 27, "\ud835\udc40": 27, "similarli": 27, "trick": 27, "compute_batch_hessian": 27, "batch_hess": 27, "naiv": [27, 30], "materi": 27, "turn": [27, 30, 32], "oppos": [27, 29], "hvp_revrev": 27, "result_hvp_revrev": 27, "interfac": 28, "fail_f": 28, "module_fail": 28, "minim": 28, "still": 28, "truncat": 28, "suffix": 28, "debug": 28, "tri": 28, "half": 28, "quarter": 28, "etc": 28, "failing_funct": 28, "symbolic_trac": 28, "anymor": 28, "search": 28, "last": 28, "8": 28, "Of": 28, "cours": 28, "isn": 28, "alwai": 28, "suffici": 28, "caus": [28, 32], "inspir": [28, 29], "node": 28, "unlik": [28, 31], "promot": 28, "middl": 28, "somewhat": 28, "explanatori": 28, "toi": 28, "multipli": 28, "failing_f": 28, "div": 28, "sub": 28, "pass_check": 28, "min_f": 28, "operatorentri": 28, "cpp": 28, "133": 28, "regist": 28, "registerschema": 28, "functorchbatch": 28, "registercompositeimplicitautograd": 28, "10338": 28, "fsx": 28, "chilli": 28, "csrc": 28, "batchrulesdecomposit": 28, "108": 28, "registerkernel": 28, "success": 28, "went": 28, "placehold": 28, "could": [28, 32], "float32": 28, "dtype": [28, 29], "jit": 28, "fuser": 28, "fuser2": 28, "tada": 28, "sinc": [28, 29], "primari": 28, "repro": 28, "practic": 28, "checker": 28, "check_nvfuser_subprocess": 28, "check_nvfuser_correctness_subprocess": 28, "failing_graph": 28, "print_compil": 28, "Or": 28, "6062": 28, "9982": 28, "6474": 28, "grad_fn": 28, "compiledfunctionbackward": 28, "nor": 28, "constant": 28, "resolv": 28, "debug_compil": 28, "past": 28, "to_fold": 28, "serial": 28, "disk": 28, "dump": 28, "fxmodul": 28, "made": 28, "minor": 28, "modif": 28, "5144": 28, "hopefulli": 28, "describ": 29, "evolv": 29, "research": [29, 30], "recent": 29, "year": 29, "fast": 29, "finit": 29, "width": 29, "cnn": [29, 30], "conv1": [29, 30], "conv2d": [29, 30], "conv2": [29, 30], "conv3": 29, "fc": 29, "21632": 29, "x_train": 29, "20": 29, "x_test": 29, "accomplish": 29, "fnet": 29, "keep": 29, "mind": 29, "written": [29, 30, 32], "point": 29, "inter": 29, "assumpt": 29, "fnet_singl": 29, "unsqueez": [29, 30], "squeez": 29, "readi": 29, "empir": 29, "x_1": 29, "x_2": 29, "j_": 29, "consist": 29, "empirical_ntk_jacobian_contract": 29, "x1": 29, "x2": 29, "j": 29, "jac1": 29, "jac2": 29, "einsum": 29, "naf": 29, "mbf": 29, "nmab": 29, "j1": 29, "j2": 29, "especi": 29, "beforehand": 29, "approxim": 29, "adjust": 29, "einsum_expr": 29, "elif": 29, "maf": 29, "nm": 29, "nma": 29, "els": 29, "asymptot": 29, "complex": 29, "o": 29, "fp": 29, "total": [29, 30], "cost": 29, "section": 29, "next": [29, 30], "reformul": 29, "ident": 29, "i_o": 29, "i_": 29, "left": [29, 31], "e_o": 29, "right": 29, "mathbb": 29, "textrm": 29, "consid": [29, 32], "_o": 29, "parallel": 29, "empirical_ntk_ntk_vp": 29, "get_ntk": 29, "func_x1": 29, "func_x2": 29, "get_ntk_slic": 29, "slice": 29, "basi": 29, "numel": 29, "actual": 29, "pair": [29, 30], "nmkk": 29, "nmk": 29, "result_from_jacobian_contract": 29, "result_from_ntk_vp": 29, "direct": 29, "translat": 29, "math": 29, "showcas": 29, "power": 29, "luck": 29, "henc": 29, "altogeth": 29, "term": 29, "therefor": 29, "fulli": 29, "connect": 29, "convolut": 29, "wise": 29, "privaci": 30, "meta": 30, "simplecnn": 30, "9216": 30, "max_pool2d": 30, "log_softmax": 30, "loss_fn": 30, "nll_loss": 30, "averag": 30, "mini": 30, "move": 30, "propog": 30, "contrast": 30, "individu": 30, "compute_grad": 30, "prepend": 30, "process": 30, "compute_sample_grad": 30, "sample_grad": 30, "shard": 30, "per_sample_grad": 30, "notic": 30, "review": 30, "functionalmodulewithbuff": 30, "stateless_model": 30, "kernel_s": 30, "stride": 30, "store": 30, "rather": 30, "compute_loss_stateless_model": 30, "ft_compute_grad": 30, "ft_compute_sample_grad": 30, "ft_per_sample_grad": 30, "doubl": 30, "hand": [30, 32], "3e": 30, "newer": 30, "a100": 30, "amper": 30, "seen": 30, "25x": 30, "second_r": 30, "first_r": 30, "0x7f71ac3f1850": 30, "79": 30, "86": 30, "0x7f7143e26f10": 30, "93": 30, "517": 30, "5791": 30, "solut": [30, 32], "opacu": 30, "But": 30, "cool": 30, "nice": 30, "name": 31, "path": 31, "impos": 31, "docstr": 31, "drop": 31, "hessian0": 31, "hessian1": 31, "bar": 31, "explan": 31, "progress": 31, "hear": 31, "encourag": 31, "convers": 31, "tracker": 31, "guarante": 32, "On": 32, "share": 32, "assign": 32, "special": 32, "subclass": 32, "z": 32, "grad_x": 32, "rewrit": 32, "receiv": 32, "messag": 32, "fundament": 32, "reason": 32, "why": 32, "relat": 32, "absenc": 32, "x_i": 32, "act": 32, "pop": 32, "hello": 32, "lst": 32, "consequ": 32, "batchedtensor": 32, "batched_tensor_input": 32, "rais": 32, "encount": 32, "unsupport": 32, "succe": 32, "occur": 32, "due": 32, "broadcast": 32, "attempt": 32, "keyword": 32, "gracefulli": 32, "theoret": 32, "chosen": 32, "yet": 32, "condit": 32, "statement": 32, "ed": 32, "custom_dot": 32, "lax": 32, "cond": 32, "while_loop": 32, "voic": 32, "is_nonzero": 32, "rag": 32, "concept": 32, "intent": 32, "unclear": 32, "address": 32, "ask": 32, "instanc": 32, "add_nois": 32, "repeat": 32, "reproduc": 32, "prng": 32, "part": 32, "introduc": 32, "form": 32, "fit": 32}, "objects": {"functorch": [[4, 0, 1, "", "combine_state_for_ensemble"], [12, 0, 1, "", "functionalize"], [13, 0, 1, "", "grad"], [14, 0, 1, "", "grad_and_value"], [15, 0, 1, "", "hessian"], [16, 0, 1, "", "jacfwd"], [17, 0, 1, "", "jacrev"], [18, 0, 1, "", "jvp"], [19, 0, 1, "", "make_functional"], [20, 0, 1, "", "make_functional_with_buffers"], [21, 0, 1, "", "vjp"], [22, 0, 1, "", "vmap"]], "functorch.compile": [[5, 0, 1, "", "aot_function"], [6, 0, 1, "", "aot_module"], [7, 0, 1, "", "default_partition"], [8, 0, 1, "", "memory_efficient_fusion"], [9, 0, 1, "", "min_cut_rematerialization_partition"], [10, 0, 1, "", "nop"], [11, 0, 1, "", "ts_compile"]]}, "objtypes": {"0": "py:function"}, "objnames": {"0": ["py", "function", "Python function"]}, "titleterms": {"functorch": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 27, 30, 31], "compil": [0, 5, 6, 7, 8, 9, 10, 11], "experiment": [0, 2], "api": [0, 23, 32], "partition": 0, "patch": 1, "batch": [1, 27], "norm": 1, "what": [1, 23, 25, 26, 30, 31], "": 1, "happen": 1, "how": [1, 25], "fix": 1, "option": 1, "1": [1, 29], "chang": 1, "batchnorm": 1, "2": [1, 29], "torchvis": 1, "paramet": 1, "3": 1, "function": [2, 3, 12, 23, 29, 31], "transform": [2, 3, 23, 27, 31], "util": 3, "work": 3, "torch": [3, 32], "nn": 3, "modul": 3, "combine_state_for_ensembl": 4, "aot_funct": 5, "aot_modul": 6, "default_partit": 7, "memory_efficient_fus": 8, "min_cut_rematerialization_partit": 9, "nop": 10, "ts_compil": 11, "grad": [13, 30, 31], "grad_and_valu": 14, "hessian": [15, 27, 31], "jacfwd": [16, 27, 31], "jacrev": [17, 27, 31], "jvp": [18, 31], "make_funct": 19, "make_functional_with_buff": 20, "vjp": [21, 31], "vmap": [22, 26, 31, 32], "ar": [23, 31], "compos": [23, 27, 31], "why": [23, 31], "read": 23, "more": [23, 27], "get": 23, "start": 23, "refer": 23, "note": 23, "tutori": 23, "instal": 24, "colab": 24, "nightli": 24, "previou": 24, "version": [24, 29], "aot": 25, "autograd": [25, 32], "us": [25, 26, 28, 30], "optim": 25, "background": 25, "you": 25, "learn": 25, "setup": [25, 29], "oper": [25, 32], "fusion": 25, "recomput": 25, "aka": 25, "activ": 25, "checkpoint": 25, "actual": 25, "usag": 25, "model": [26, 29], "ensembl": 26, "i": [26, 30, 31], "vector": [26, 27, 29, 31], "perform": [26, 30], "jacobian": [27, 29, 31], "hvp": 27, "vhp": 27, "comput": [27, 29, 31], "revers": 27, "mode": 27, "v": 27, "forward": 27, "product": [27, 29, 31], "minifi": 28, "neural": 29, "tangent": 29, "kernel": 29, "creat": 29, "ntk": 29, "method": 29, "contract": 29, "per": 30, "sampl": 30, "gradient": [30, 31], "effici": 30, "wai": 30, "comparison": 30, "whirlwind": 31, "tour": 31, "auto": 31, "conclus": 31, "ux": 32, "limit": 32, "gener": 32, "mutat": 32, "arbitrari": 32, "python": 32, "data": 32, "structur": 32, "place": 32, "pytorch": 32, "out": 32, "depend": 32, "control": 32, "flow": 32, "item": 32, "dynam": 32, "shape": 32, "nonzero": 32, "friend": 32, "random": 32}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"functorch.compile (experimental)": [[0, "functorch-compile-experimental"]], "Compilation APIs (experimental)": [[0, "compilation-apis-experimental"]], "Partitioners (experimental)": [[0, "partitioners-experimental"]], "Compilers (experimental)": [[0, "compilers-experimental"]], "Patching Batch Norm": [[1, "patching-batch-norm"]], "What\u2019s happening?": [[1, "what-s-happening"]], "How to fix": [[1, "how-to-fix"]], "Option 1: Change the BatchNorm": [[1, "option-1-change-the-batchnorm"]], "Option 2: torchvision parameter": [[1, "option-2-torchvision-parameter"]], "Option 3: functorch\u2019s patching": [[1, "option-3-functorch-s-patching"]], "functorch.experimental": [[2, "functorch-experimental"]], "Experimental Function Transforms": [[2, "experimental-function-transforms"]], "functorch": [[3, "functorch"], [23, "functorch"]], "Function Transforms": [[3, "function-transforms"]], "Utilities for working with torch.nn.Modules": [[3, "utilities-for-working-with-torch-nn-modules"]], "functorch.combine_state_for_ensemble": [[4, "functorch-combine-state-for-ensemble"]], "functorch.compile.aot_function": [[5, "functorch-compile-aot-function"]], "functorch.compile.aot_module": [[6, "functorch-compile-aot-module"]], "functorch.compile.default_partition": [[7, "functorch-compile-default-partition"]], "functorch.compile.memory_efficient_fusion": [[8, "functorch-compile-memory-efficient-fusion"]], "functorch.compile.min_cut_rematerialization_partition": [[9, "functorch-compile-min-cut-rematerialization-partition"]], "functorch.compile.nop": [[10, "functorch-compile-nop"]], "functorch.compile.ts_compile": [[11, "functorch-compile-ts-compile"]], "functorch.functionalize": [[12, "functorch-functionalize"]], "functorch.grad": [[13, "functorch-grad"]], "functorch.grad_and_value": [[14, "functorch-grad-and-value"]], "functorch.hessian": [[15, "functorch-hessian"]], "functorch.jacfwd": [[16, "functorch-jacfwd"]], "functorch.jacrev": [[17, "functorch-jacrev"]], "functorch.jvp": [[18, "functorch-jvp"]], "functorch.make_functional": [[19, "functorch-make-functional"]], "functorch.make_functional_with_buffers": [[20, "functorch-make-functional-with-buffers"]], "functorch.vjp": [[21, "functorch-vjp"]], "functorch.vmap": [[22, "functorch-vmap"]], "What are composable function transforms?": [[23, "what-are-composable-function-transforms"]], "Why composable function transforms?": [[23, "why-composable-function-transforms"], [31, "why-composable-function-transforms"]], "Read More": [[23, "read-more"]], "functorch: Getting Started": [[23, null]], "functorch API Reference and Notes": [[23, null]], "functorch Tutorials": [[23, null]], "Install functorch": [[24, "install-functorch"]], "Colab": [[24, "colab"]], "Nightly": [[24, "nightly"]], "Previous Versions": [[24, "previous-versions"]], "AOT Autograd - How to use and optimize?": [[25, "aot-autograd-how-to-use-and-optimize"]], "Background": [[25, "background"]], "What will you learn?": [[25, "what-will-you-learn"]], "Setup": [[25, "setup"], [29, "setup"]], "Use AOT Autograd": [[25, "use-aot-autograd"]], "Operator Fusion": [[25, "operator-fusion"]], "Recomputation (aka Activation Checkpointing)": [[25, "recomputation-aka-activation-checkpointing"]], "Actual Usage": [[25, "actual-usage"]], "Model ensembling": [[26, "model-ensembling"]], "What is model ensembling?": [[26, "what-is-model-ensembling"]], "Using vmap to vectorize the ensemble": [[26, "using-vmap-to-vectorize-the-ensemble"]], "Performance": [[26, "performance"]], "Jacobians, Hessians, hvp, vhp, and more: composing functorch transforms": [[27, "jacobians-hessians-hvp-vhp-and-more-composing-functorch-transforms"]], "Computing the Jacobian": [[27, "computing-the-jacobian"]], "reverse-mode Jacobian (jacrev) vs forward-mode Jacobian (jacfwd)": [[27, "reverse-mode-jacobian-jacrev-vs-forward-mode-jacobian-jacfwd"]], "Hessian computation with functorch.hessian": [[27, "hessian-computation-with-functorch-hessian"]], "Batch Jacobian and Batch Hessian": [[27, "batch-jacobian-and-batch-hessian"]], "Computing Hessian-vector products": [[27, "computing-hessian-vector-products"]], "Using the Minifier": [[28, "using-the-minifier"]], "Neural Tangent Kernels": [[29, "neural-tangent-kernels"]], "Create a function version of the model": [[29, "create-a-function-version-of-the-model"]], "Compute the NTK: method 1 (Jacobian contraction)": [[29, "compute-the-ntk-method-1-jacobian-contraction"]], "Compute the NTK: method 2 (NTK-vector products)": [[29, "compute-the-ntk-method-2-ntk-vector-products"]], "Per-sample-gradients": [[30, "per-sample-gradients"]], "What is it?": [[30, "what-is-it"]], "Per-sample-grads, the efficient way, using functorch": [[30, "per-sample-grads-the-efficient-way-using-functorch"]], "Performance comparison": [[30, "performance-comparison"]], "Whirlwind Tour": [[31, "whirlwind-tour"]], "What is functorch?": [[31, "what-is-functorch"]], "What are the transforms?": [[31, "what-are-the-transforms"]], "grad (gradient computation)": [[31, "grad-gradient-computation"]], "vmap (auto-vectorization)": [[31, "vmap-auto-vectorization"]], "vjp (vector-Jacobian product)": [[31, "vjp-vector-jacobian-product"]], "jvp (Jacobian-vector product)": [[31, "jvp-jacobian-vector-product"]], "jacrev, jacfwd, and hessian": [[31, "jacrev-jacfwd-and-hessian"]], "Conclusion": [[31, "conclusion"]], "UX Limitations": [[32, "ux-limitations"]], "General limitations": [[32, "general-limitations"]], "torch.autograd APIs": [[32, "torch-autograd-apis"]], "vmap limitations": [[32, "vmap-limitations"]], "Mutation: Arbitrary mutation of Python data structures": [[32, "mutation-arbitrary-mutation-of-python-data-structures"]], "Mutation: in-place PyTorch Operations": [[32, "mutation-in-place-pytorch-operations"]], "Mutation: out= PyTorch Operations": [[32, "mutation-out-pytorch-operations"]], "Data-dependent Python control flow": [[32, "data-dependent-python-control-flow"]], "Data-dependent operations (.item())": [[32, "data-dependent-operations-item"]], "Dynamic shape operations (nonzero and friends)": [[32, "dynamic-shape-operations-nonzero-and-friends"]], "Randomness": [[32, "randomness"]]}, "indexentries": {"combine_state_for_ensemble() (in module functorch)": [[4, "functorch.combine_state_for_ensemble"]], "aot_function() (in module functorch.compile)": [[5, "functorch.compile.aot_function"]], "aot_module() (in module functorch.compile)": [[6, "functorch.compile.aot_module"]], "default_partition() (in module functorch.compile)": [[7, "functorch.compile.default_partition"]], "memory_efficient_fusion() (in module functorch.compile)": [[8, "functorch.compile.memory_efficient_fusion"]], "min_cut_rematerialization_partition() (in module functorch.compile)": [[9, "functorch.compile.min_cut_rematerialization_partition"]], "nop() (in module functorch.compile)": [[10, "functorch.compile.nop"]], "ts_compile() (in module functorch.compile)": [[11, "functorch.compile.ts_compile"]], "functionalize() (in module functorch)": [[12, "functorch.functionalize"]], "grad() (in module functorch)": [[13, "functorch.grad"]], "grad_and_value() (in module functorch)": [[14, "functorch.grad_and_value"]], "hessian() (in module functorch)": [[15, "functorch.hessian"]], "jacfwd() (in module functorch)": [[16, "functorch.jacfwd"]], "jacrev() (in module functorch)": [[17, "functorch.jacrev"]], "jvp() (in module functorch)": [[18, "functorch.jvp"]], "make_functional() (in module functorch)": [[19, "functorch.make_functional"]], "make_functional_with_buffers() (in module functorch)": [[20, "functorch.make_functional_with_buffers"]], "vjp() (in module functorch)": [[21, "functorch.vjp"]], "vmap() (in module functorch)": [[22, "functorch.vmap"]]}})